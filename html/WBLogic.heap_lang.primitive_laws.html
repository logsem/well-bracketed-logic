<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../index.html">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">WBLogic.heap_lang.primitive_laws</h1>

<div class="code">
</div>

<div class="doc">
This file proves the basic laws of the HeapLang program logic by applying
the Iris lifting lemmas. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">primitive_laws</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.bi.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">fractional</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">mono_nat</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">gen_heap</span> <span class="id" title="library">proph_map</span> <span class="id" title="library">gen_inv_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">WBLogic.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#"><span class="id" title="library">weakestpre</span></a> <a class="idref" href="WBLogic.program_logic.lifting.html#"><span class="id" title="library">lifting</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">ectx_lifting</span> <span class="id" title="library">total_ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">class_instances</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">tactics</span> <span class="id" title="library">notation</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">options</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="wbheapGS" class="idref" href="#wbheapGS"><span class="id" title="record">wbheapGS</span></a> <a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a> := <span class="id" title="var">WBHeapGS</span> {<br/>
&nbsp;&nbsp;<a id="wbheapGS_invGS" class="idref" href="#wbheapGS_invGS"><span class="id" title="projection">wbheapGS_invGS</span></a> : <span class="id" title="class">invGS_gen</span> <span class="id" title="constructor">HasLc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="wbheapGS_gen_heapGS" class="idref" href="#wbheapGS_gen_heapGS"><span class="id" title="projection">wbheapGS_gen_heapGS</span></a> :: <span class="id" title="class">gen_heapGS</span> <span class="id" title="record">loc</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="inductive">val</span>) <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="wbheapGS_inv_heapGS" class="idref" href="#wbheapGS_inv_heapGS"><span class="id" title="projection">wbheapGS_inv_heapGS</span></a> :: <span class="id" title="class">inv_heapGS</span> <span class="id" title="record">loc</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <span class="id" title="inductive">val</span>) <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="wbheapGS_proph_mapGS" class="idref" href="#wbheapGS_proph_mapGS"><span class="id" title="projection">wbheapGS_proph_mapGS</span></a> :: <span class="id" title="class">proph_mapGS</span> <span class="id" title="definition">proph_id</span> (<span class="id" title="inductive">val</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="inductive">val</span>) <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="wbheapGS_step_name" class="idref" href="#wbheapGS_step_name"><span class="id" title="projection">wbheapGS_step_name</span></a> : <span class="id" title="definition">gname</span>;<br/>
&nbsp;&nbsp;<a id="wbheapGS_step_cnt" class="idref" href="#wbheapGS_step_cnt"><span class="id" title="projection">wbheapGS_step_cnt</span></a> : <span class="id" title="class">mono_natG</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="wbheapGS_gstacksGS" class="idref" href="#wbheapGS_gstacksGS"><span class="id" title="projection">wbheapGS_gstacksGS</span></a> :: <a class="idref" href="WBLogic.program_logic.ghost_stacks.html#gstacksIG"><span class="id" title="class">gstacksIG</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="variable">Σ</span></a>;<br/>
}.<br/>
<span class="id" title="keyword">Local Existing Instance</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#wbheapGS_step_cnt"><span class="id" title="method">wbheapGS_step_cnt</span></a>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="wbheapGS_heapGS" class="idref" href="#wbheapGS_heapGS"><span class="id" title="instance">wbheapGS_heapGS</span></a> `{<a id="wbheapGS0:11" class="idref" href="#wbheapGS0:11"><span class="id" title="binder">!</span></a><a id="wbheapGS0:11" class="idref" href="#wbheapGS0:11"><span class="id" title="binder">wbheapGS</span></a> <a id="2ab75602e9b8af2ca6fd6dbdb1e68a19" class="idref" href="#2ab75602e9b8af2ca6fd6dbdb1e68a19"><span class="id" title="binder"><span id="wbheapGS0:11" class="id">Σ</span></span></a>} : <span class="id" title="abbreviation">heapGS</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#2ab75602e9b8af2ca6fd6dbdb1e68a19"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="constructor">HeapGS</span> <span class="id" title="constructor">HasLc</span> <span class="id" title="var">Σ</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#wbheapGS_invGS"><span class="id" title="method">wbheapGS_invGS</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#wbheapGS_step_name"><span class="id" title="method">wbheapGS_step_name</span></a> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="lifting" class="idref" href="#lifting"><span class="id" title="section">lifting</span></a>.<br/>
<span class="id" title="keyword">Context</span> `{<a id="wbheapGS0:13" class="idref" href="#wbheapGS0:13"><span class="id" title="binder">!</span></a><a id="wbheapGS0:13" class="idref" href="#wbheapGS0:13"><span class="id" title="binder">wbheapGS</span></a> <a id="6065d52c95091350a1253a1d7148d2c7" class="idref" href="#6065d52c95091350a1253a1d7148d2c7"><span class="id" title="binder"><span id="wbheapGS0:13" class="id">Σ</span></span></a>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#3f5501ec6239ef23d42bb010db261e47"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Φ</span> <span class="id" title="var">Ψ</span> : <span class="id" title="inductive">val</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#3f5501ec6239ef23d42bb010db261e47"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">efs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="inductive">expr</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <span class="id" title="record">state</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <span class="id" title="inductive">val</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">l</span> : <span class="id" title="record">loc</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_lb_init" class="idref" href="#wbwp_lb_init"><span class="id" title="lemma">wbwp_lb_init</span></a> <a id="E:14" class="idref" href="#E:14"><span class="id" title="binder">E</span></a> <a id="out:15" class="idref" href="#out:15"><span class="id" title="binder">out</span></a> <a id="e:16" class="idref" href="#e:16"><span class="id" title="binder">e</span></a> <a id="e95ea34df6288a180d94f2fc7a6f94a5" class="idref" href="#e95ea34df6288a180d94f2fc7a6f94a5"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="class">TCEq</span> (<span class="id" title="definition">to_val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:16"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="definition">steps_lb</span> 0 <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:16"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:15"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:14"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">{{</span></a> <a id="v:18" class="idref" href="#v:18"><span class="id" title="binder">v</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">,</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e95ea34df6288a180d94f2fc7a6f94a5"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:18"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">}}</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:16"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:15"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:14"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e95ea34df6288a180d94f2fc7a6f94a5"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.program_logic.weakestpre.html#wbwp"><span class="id" title="definition">wbwp</span></a>. <span class="id" title="var">iIntros</span> (?) "Hwp". <span class="id" title="var">iIntros</span> (<span class="id" title="var">M</span>) "HM".<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_lb_init</span>  <span class="id" title="notation">with</span> "[Hwp HM]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hslb". <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hwp" <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_lb_update" class="idref" href="#wbwp_lb_update"><span class="id" title="lemma">wbwp_lb_update</span></a> <a id="n:19" class="idref" href="#n:19"><span class="id" title="binder">n</span></a> <a id="E:20" class="idref" href="#E:20"><span class="id" title="binder">E</span></a> <a id="out:21" class="idref" href="#out:21"><span class="id" title="binder">out</span></a> <a id="e:22" class="idref" href="#e:22"><span class="id" title="binder">e</span></a> <a id="a5256c6d8a1d83cac3c896988491670e" class="idref" href="#a5256c6d8a1d83cac3c896988491670e"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="class">TCEq</span> (<span class="id" title="definition">to_val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:22"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">steps_lb</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:19"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:22"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:21"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:20"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">{{</span></a> <a id="v:24" class="idref" href="#v:24"><span class="id" title="binder">v</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">,</span></a> <span class="id" title="definition">steps_lb</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:19"><span class="id" title="variable">n</span></a>) <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#a5256c6d8a1d83cac3c896988491670e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:24"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">}}</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:22"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:21"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:20"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#a5256c6d8a1d83cac3c896988491670e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.program_logic.weakestpre.html#wbwp"><span class="id" title="definition">wbwp</span></a>. <span class="id" title="var">iIntros</span> (?) "Hslb Hwp". <span class="id" title="var">iIntros</span> (<span class="id" title="var">M</span>) "HM".<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_lb_update</span>  <span class="id" title="notation">with</span> "[$Hslb]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_wand</span> <span class="id" title="notation">with</span> "[Hwp HM]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?). <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (?) "(?&amp;?&amp;H)". <span class="id" title="var">iIntros</span> "Hslb".<br/>
&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iApply</span> "H"; <span class="id" title="var">done</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_step_fupdN_lb" class="idref" href="#wbwp_step_fupdN_lb"><span class="id" title="lemma">wbwp_step_fupdN_lb</span></a> <a id="n:25" class="idref" href="#n:25"><span class="id" title="binder">n</span></a> <a id="E1:26" class="idref" href="#E1:26"><span class="id" title="binder">E1</span></a> <a id="E2:27" class="idref" href="#E2:27"><span class="id" title="binder">E2</span></a> <a id="out:28" class="idref" href="#out:28"><span class="id" title="binder">out</span></a> <a id="e:29" class="idref" href="#e:29"><span class="id" title="binder">e</span></a> <a id="P:30" class="idref" href="#P:30"><span class="id" title="binder">P</span></a> <a id="5bd90bff1377a72e77b9ec2eb3e5e956" class="idref" href="#5bd90bff1377a72e77b9ec2eb3e5e956"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="class">TCEq</span> (<span class="id" title="definition">to_val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:29"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E2:27"><span class="id" title="variable">E2</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E1:26"><span class="id" title="variable">E1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">steps_lb</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:25"><span class="id" title="variable">n</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">|={</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E1:26"><span class="id" title="variable">E1</span></a><span class="id" title="notation">∖</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E2:27"><span class="id" title="variable">E2</span></a><span class="id" title="notation">,</span><span class="id" title="notation">∅</span><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">|={</span><span class="id" title="notation">∅</span><span class="id" title="notation">}▷=&gt;^(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:25"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">|={</span><span class="id" title="notation">∅</span><span class="id" title="notation">,</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E1:26"><span class="id" title="variable">E1</span></a><span class="id" title="notation">∖</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E2:27"><span class="id" title="variable">E2</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#P:30"><span class="id" title="variable">P</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:29"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:28"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E2:27"><span class="id" title="variable">E2</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">{{</span></a> <a id="v:32" class="idref" href="#v:32"><span class="id" title="binder">v</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">,</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#P:30"><span class="id" title="variable">P</span></a> <span class="id" title="notation">={</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E1:26"><span class="id" title="variable">E1</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#5bd90bff1377a72e77b9ec2eb3e5e956"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:32"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">}}</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:29"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:28"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E1:26"><span class="id" title="variable">E1</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#5bd90bff1377a72e77b9ec2eb3e5e956"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">He</span> <span class="id" title="var">HE</span>) "Hlb HP Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.program_logic.weakestpre.html#wbwp"><span class="id" title="definition">wbwp</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "HM".<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_step_fupdN_lb</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>; [<span class="id" title="var">done</span>|].<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_wand</span> <span class="id" title="notation">with</span> "[Hwp HM]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hwp".<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?). <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (?) "(?&amp;?&amp;H)". <span class="id" title="var">iIntros</span> "HP".<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">with</span> "HP"<span class="id" title="notation">)</span>; <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Recursive functions: we do not use this lemmas as it is easier to use Löb
induction directly, but this demonstrates that we can state the expected
reasoning principle for recursive functions, without any visible ▷. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="43d40b776d7952fd7432b25ad19921f8" class="idref" href="#43d40b776d7952fd7432b25ad19921f8"><span class="id" title="lemma">wp_rec_löb</span></a> <a id="s:33" class="idref" href="#s:33"><span class="id" title="binder">s</span></a> <a id="E:34" class="idref" href="#E:34"><span class="id" title="binder">E</span></a> <a id="f:35" class="idref" href="#f:35"><span class="id" title="binder">f</span></a> <a id="x:36" class="idref" href="#x:36"><span class="id" title="binder">x</span></a> <a id="e:37" class="idref" href="#e:37"><span class="id" title="binder">e</span></a> <a id="01609205a32fbfabf4636f929e17e6ac" class="idref" href="#01609205a32fbfabf4636f929e17e6ac"><span class="id" title="binder">Φ</span></a> <a id="4b113f67f4e9e043eab3307cba17213c" class="idref" href="#4b113f67f4e9e043eab3307cba17213c"><span class="id" title="binder">Ψ</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">□</span> <span class="id" title="notation">(</span> <span class="id" title="notation">□</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="v:40" class="idref" href="#v:40"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#4b113f67f4e9e043eab3307cba17213c"><span class="id" title="variable">Ψ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:40"><span class="id" title="variable">v</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> (<span class="id" title="notation">rec</span><span class="id" title="notation">:</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#f:35"><span class="id" title="variable">f</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#x:36"><span class="id" title="variable">x</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:37"><span class="id" title="variable">e</span></a>)%<span class="id" title="var">V</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:40"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#s:33"><span class="id" title="variable">s</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:34"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#01609205a32fbfabf4636f929e17e6ac"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∀</span> <a id="v:41" class="idref" href="#v:41"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#4b113f67f4e9e043eab3307cba17213c"><span class="id" title="variable">Ψ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:41"><span class="id" title="variable">v</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">(</span></a><span class="id" title="definition">subst'</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#x:36"><span class="id" title="variable">x</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:41"><span class="id" title="variable">v</span></a> (<span class="id" title="definition">subst'</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#f:35"><span class="id" title="variable">f</span></a> (<span class="id" title="notation">rec</span><span class="id" title="notation">:</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#f:35"><span class="id" title="variable">f</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#x:36"><span class="id" title="variable">x</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:37"><span class="id" title="variable">e</span></a>) <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:37"><span class="id" title="variable">e</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">)</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#s:33"><span class="id" title="variable">s</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:34"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#01609205a32fbfabf4636f929e17e6ac"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<span class="id" title="notation">∀</span> <a id="v:42" class="idref" href="#v:42"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#4b113f67f4e9e043eab3307cba17213c"><span class="id" title="variable">Ψ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:42"><span class="id" title="variable">v</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> (<span class="id" title="notation">rec</span><span class="id" title="notation">:</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#f:35"><span class="id" title="variable">f</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#x:36"><span class="id" title="variable">x</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:37"><span class="id" title="variable">e</span></a>)%<span class="id" title="var">V</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:42"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#s:33"><span class="id" title="variable">s</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:34"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#01609205a32fbfabf4636f929e17e6ac"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "#Hrec". <span class="id" title="var">iLöb</span> <span class="id" title="keyword">as</span> "IH". <span class="id" title="var">iIntros</span> (<span class="id" title="var">v</span>) "HΨ".<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.lifting.html#wbwp_pure_step_later"><span class="id" title="lemma">wbwp_pure_step_later</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "!&gt; _". <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hrec" <span class="id" title="notation">with</span> "[] HΨ"<span class="id" title="notation">)</span>. <span class="id" title="var">iIntros</span> "!&gt;" (<span class="id" title="var">w</span>) "HΨ".<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"IH" <span class="id" title="notation">with</span> "HΨ"<span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Forks&nbsp;break&nbsp;well-bracketedness!&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;<span class="comment">(**&nbsp;Fork:&nbsp;Not&nbsp;using&nbsp;Texan&nbsp;triples&nbsp;to&nbsp;avoid&nbsp;some&nbsp;unnecessary&nbsp;<span class="inlinecode"><span class="id" title="var">True</span></span>&nbsp;*)</span>&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Lemma&nbsp;wp_fork&nbsp;s&nbsp;E&nbsp;e&nbsp;Φ&nbsp;:&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;▷&nbsp;WP&nbsp;e&nbsp;@&nbsp;s;&nbsp;⊤&nbsp;{{&nbsp;_,&nbsp;True&nbsp;}}&nbsp;-∗&nbsp;▷&nbsp;Φ&nbsp;(LitV&nbsp;LitUnit)&nbsp;-∗&nbsp;WP&nbsp;Fork&nbsp;e&nbsp;@&nbsp;s;&nbsp;E&nbsp;{{&nbsp;Φ&nbsp;}}.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"He&nbsp;HΦ".&nbsp;iApply&nbsp;wp_lift_atomic_head_step;&nbsp;<span class="inlinecode"><span class="id" title="var">done</span>|</span>.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(σ1&nbsp;ns&nbsp;κ&nbsp;κs&nbsp;nt)&nbsp;"(?&amp;?&amp;Hsteps)&nbsp;!&gt;";&nbsp;iSplit;&nbsp;first&nbsp;by&nbsp;eauto&nbsp;with&nbsp;head_step.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"!&gt;"&nbsp;(v2&nbsp;σ2&nbsp;efs&nbsp;Hstep)&nbsp;"_";&nbsp;inv_head_step.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;iMod&nbsp;(steps_auth_update_S&nbsp;with&nbsp;"Hsteps")&nbsp;as&nbsp;"Hsteps".&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;iFrame.&nbsp;*)</span><br/>
<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
Heap 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_allocN_seq" class="idref" href="#wbwp_allocN_seq"><span class="id" title="lemma">wbwp_allocN_seq</span></a> <a id="E:43" class="idref" href="#E:43"><span class="id" title="binder">E</span></a> <a id="out:44" class="idref" href="#out:44"><span class="id" title="binder">out</span></a> <a id="v:45" class="idref" href="#v:45"><span class="id" title="binder">v</span></a> <a id="n:46" class="idref" href="#n:46"><span class="id" title="binder">n</span></a> :<br/>
&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#::Z_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:46"><span class="id" title="variable">n</span></a>)%<span class="id" title="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">True</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">AllocN</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitInt</span> <span class="id" title="notation">$</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:46"><span class="id" title="variable">n</span></a>) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:45"><span class="id" title="variable">v</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:44"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:43"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{{{</span></a> <a id="l:47" class="idref" href="#l:47"><span class="id" title="binder">l</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">,</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:47"><span class="id" title="variable">l</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">;</span></a> <span class="id" title="notation">[∗</span> <span class="id" title="notation">list</span><span class="id" title="notation">]</span> <a id="i:48" class="idref" href="#i:48"><span class="id" title="binder"><span id="i:49" class="id">i</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#seq"><span class="id" title="definition">seq</span></a> 0 (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#Z.to_nat"><span class="id" title="definition">Z.to_nat</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#n:46"><span class="id" title="variable">n</span></a>)<span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:47"><span class="id" title="variable">l</span></a> <span class="id" title="notation">+ₗ</span> <span class="id" title="notation">(</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i:48"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:45"><span class="id" title="variable">v</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">meta_token</span> (<a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:47"><span class="id" title="variable">l</span></a> <span class="id" title="notation">+ₗ</span> <span class="id" title="notation">(</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i:48"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><span class="id" title="notation">)</span>) <span class="id" title="notation">⊤</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Hn</span> <span class="id" title="var">Φ</span>) "_ HΦ"; <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_allocN_seq</span>; <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_alloc" class="idref" href="#wbwp_alloc"><span class="id" title="lemma">wbwp_alloc</span></a> <a id="E:50" class="idref" href="#E:50"><span class="id" title="binder">E</span></a> <a id="out:51" class="idref" href="#out:51"><span class="id" title="binder">out</span></a> <a id="v:52" class="idref" href="#v:52"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">True</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">}}}</span></a> <span class="id" title="abbreviation">Alloc</span> (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:52"><span class="id" title="variable">v</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:51"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:50"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{{{</span></a> <a id="l:53" class="idref" href="#l:53"><span class="id" title="binder">l</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">,</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:53"><span class="id" title="variable">l</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:53"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:52"><span class="id" title="variable">v</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">meta_token</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:53"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⊤</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "_ HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_alloc</span>; <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_free" class="idref" href="#wbwp_free"><span class="id" title="lemma">wbwp_free</span></a> <a id="E:54" class="idref" href="#E:54"><span class="id" title="binder">E</span></a> <a id="out:55" class="idref" href="#out:55"><span class="id" title="binder">out</span></a> <a id="l:56" class="idref" href="#l:56"><span class="id" title="binder">l</span></a> <a id="v:57" class="idref" href="#v:57"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:56"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:57"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">Free</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:56"><span class="id" title="variable">l</span></a>)) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:55"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:54"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">LitV</span> <span class="id" title="constructor">LitUnit</span><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <span class="id" title="notation">True</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_free</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_load" class="idref" href="#wbwp_load"><span class="id" title="lemma">wbwp_load</span></a> <a id="E:58" class="idref" href="#E:58"><span class="id" title="binder">E</span></a> <a id="out:59" class="idref" href="#out:59"><span class="id" title="binder">out</span></a> <a id="l:60" class="idref" href="#l:60"><span class="id" title="binder">l</span></a> <a id="dq:61" class="idref" href="#dq:61"><span class="id" title="binder">dq</span></a> <a id="v:62" class="idref" href="#v:62"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:60"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span><span class="id" title="notation">{</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#dq:61"><span class="id" title="variable">dq</span></a><span class="id" title="notation">}</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:62"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">Load</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:60"><span class="id" title="variable">l</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:59"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:58"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:62"><span class="id" title="variable">v</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:60"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span><span class="id" title="notation">{</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#dq:61"><span class="id" title="variable">dq</span></a><span class="id" title="notation">}</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:62"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_load</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_store" class="idref" href="#wbwp_store"><span class="id" title="lemma">wbwp_store</span></a> <a id="E:63" class="idref" href="#E:63"><span class="id" title="binder">E</span></a> <a id="out:64" class="idref" href="#out:64"><span class="id" title="binder">out</span></a> <a id="l:65" class="idref" href="#l:65"><span class="id" title="binder">l</span></a> <a id="v':66" class="idref" href="#v':66"><span class="id" title="binder">v'</span></a> <a id="v:67" class="idref" href="#v:67"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:65"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':66"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">Store</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:65"><span class="id" title="variable">l</span></a>)) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:67"><span class="id" title="variable">v</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:64"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:63"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">LitV</span> <span class="id" title="constructor">LitUnit</span><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:65"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:67"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_store</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_xchg" class="idref" href="#wbwp_xchg"><span class="id" title="lemma">wbwp_xchg</span></a> <a id="E:68" class="idref" href="#E:68"><span class="id" title="binder">E</span></a> <a id="out:69" class="idref" href="#out:69"><span class="id" title="binder">out</span></a> <a id="l:70" class="idref" href="#l:70"><span class="id" title="binder">l</span></a> <a id="v':71" class="idref" href="#v':71"><span class="id" title="binder">v'</span></a> <a id="v:72" class="idref" href="#v:72"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:70"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':71"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">Xchg</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:70"><span class="id" title="variable">l</span></a>)) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:72"><span class="id" title="variable">v</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:69"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:68"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':71"><span class="id" title="variable">v'</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:70"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:72"><span class="id" title="variable">v</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_xchg</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_cmpxchg_fail" class="idref" href="#wbwp_cmpxchg_fail"><span class="id" title="lemma">wbwp_cmpxchg_fail</span></a> <a id="E:73" class="idref" href="#E:73"><span class="id" title="binder">E</span></a> <a id="out:74" class="idref" href="#out:74"><span class="id" title="binder">out</span></a> <a id="l:75" class="idref" href="#l:75"><span class="id" title="binder">l</span></a> <a id="dq:76" class="idref" href="#dq:76"><span class="id" title="binder">dq</span></a> <a id="v':77" class="idref" href="#v':77"><span class="id" title="binder">v'</span></a> <a id="v1:78" class="idref" href="#v1:78"><span class="id" title="binder">v1</span></a> <a id="v2:79" class="idref" href="#v2:79"><span class="id" title="binder">v2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':77"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v1:78"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="definition">vals_compare_safe</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':77"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v1:78"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:75"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span><span class="id" title="notation">{</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#dq:76"><span class="id" title="variable">dq</span></a><span class="id" title="notation">}</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':77"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">CmpXchg</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:75"><span class="id" title="variable">l</span></a>) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v1:78"><span class="id" title="variable">v1</span></a>) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v2:79"><span class="id" title="variable">v2</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:74"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:73"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">PairV</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':77"><span class="id" title="variable">v'</span></a> (<span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitBool</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:75"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span><span class="id" title="notation">{</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#dq:76"><span class="id" title="variable">dq</span></a><span class="id" title="notation">}</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':77"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (? ? <span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_cmpxchg_fail</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>; <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_cmpxchg_suc" class="idref" href="#wbwp_cmpxchg_suc"><span class="id" title="lemma">wbwp_cmpxchg_suc</span></a> <a id="E:80" class="idref" href="#E:80"><span class="id" title="binder">E</span></a> <a id="out:81" class="idref" href="#out:81"><span class="id" title="binder">out</span></a> <a id="l:82" class="idref" href="#l:82"><span class="id" title="binder">l</span></a> <a id="v1:83" class="idref" href="#v1:83"><span class="id" title="binder">v1</span></a> <a id="v2:84" class="idref" href="#v2:84"><span class="id" title="binder">v2</span></a> <a id="v':85" class="idref" href="#v':85"><span class="id" title="binder">v'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':85"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v1:83"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="definition">vals_compare_safe</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':85"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v1:83"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:82"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':85"><span class="id" title="variable">v'</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">CmpXchg</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:82"><span class="id" title="variable">l</span></a>) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v1:83"><span class="id" title="variable">v1</span></a>) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v2:84"><span class="id" title="variable">v2</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:81"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:80"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">PairV</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v':85"><span class="id" title="variable">v'</span></a> (<span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitBool</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:82"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v2:84"><span class="id" title="variable">v2</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (?? <span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_cmpxchg_suc</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>; <span class="id" title="var">done</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_faa" class="idref" href="#wbwp_faa"><span class="id" title="lemma">wbwp_faa</span></a> <a id="E:86" class="idref" href="#E:86"><span class="id" title="binder">E</span></a> <a id="out:87" class="idref" href="#out:87"><span class="id" title="binder">out</span></a> <a id="l:88" class="idref" href="#l:88"><span class="id" title="binder">l</span></a> <a id="i1:89" class="idref" href="#i1:89"><span class="id" title="binder">i1</span></a> <a id="i2:90" class="idref" href="#i2:90"><span class="id" title="binder">i2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:88"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitInt</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i1:89"><span class="id" title="variable">i1</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a> <span class="id" title="constructor">FAA</span> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitLoc</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:88"><span class="id" title="variable">l</span></a>) (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitInt</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i2:90"><span class="id" title="variable">i2</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:87"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:86"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">{{{</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">RET</span></a> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitInt</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i1:89"><span class="id" title="variable">i1</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#l:88"><span class="id" title="variable">l</span></a> <span class="id" title="notation">↦</span> <span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitInt</span> (<a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i1:89"><span class="id" title="variable">i1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#i2:90"><span class="id" title="variable">i2</span></a>)) <a class="idref" href="WBLogic.program_logic.weakestpre.html#b123b7ada5e8681df69d4380d42f51d4"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "&gt;H HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_faa</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_new_proph" class="idref" href="#wbwp_new_proph"><span class="id" title="lemma">wbwp_new_proph</span></a> <a id="E:91" class="idref" href="#E:91"><span class="id" title="binder">E</span></a> <a id="out:92" class="idref" href="#out:92"><span class="id" title="binder">out</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">WB</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{{</span></a> <span class="id" title="notation">True</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">}}}</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">NewProph</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:92"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:91"><span class="id" title="variable">E</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">{{{</span></a> <a id="pvs:93" class="idref" href="#pvs:93"><span class="id" title="binder">pvs</span></a> <a id="p:94" class="idref" href="#p:94"><span class="id" title="binder">p</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">,</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">RET</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">(</span></a><span class="id" title="constructor">LitV</span> (<span class="id" title="constructor">LitProphecy</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#p:94"><span class="id" title="variable">p</span></a>)<a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">);</span></a> <span class="id" title="definition">proph</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#p:94"><span class="id" title="variable">p</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#pvs:93"><span class="id" title="variable">pvs</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#f18ec7e1f1ac01c7be72b6f7a2b0e622"><span class="id" title="notation">}}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span> (<span class="id" title="var">Φ</span>) "_ HΦ". <span class="id" title="var">iApply</span> <a class="idref" href="WBLogic.program_logic.weakestpre.html#wp_wbwp"><span class="id" title="lemma">wp_wbwp</span></a>; <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_new_proph</span> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;In&nbsp;the&nbsp;following,&nbsp;strong&nbsp;atomicity&nbsp;is&nbsp;required&nbsp;due&nbsp;to&nbsp;the&nbsp;fact&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;must<br/>
be&nbsp;able&nbsp;to&nbsp;make&nbsp;a&nbsp;head&nbsp;step&nbsp;for&nbsp;<span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span>&nbsp;not&nbsp;to&nbsp;be&nbsp;(head)&nbsp;stuck.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wbwp_resolve" class="idref" href="#wbwp_resolve"><span class="id" title="lemma">wbwp_resolve</span></a> <a id="E:95" class="idref" href="#E:95"><span class="id" title="binder">E</span></a> <a id="out:96" class="idref" href="#out:96"><span class="id" title="binder">out</span></a> <a id="e:97" class="idref" href="#e:97"><span class="id" title="binder">e</span></a> <a id="848afab06bf12743b7d5ad588f763841" class="idref" href="#848afab06bf12743b7d5ad588f763841"><span class="id" title="binder">Φ</span></a> (<a id="p:99" class="idref" href="#p:99"><span class="id" title="binder">p</span></a> : <span class="id" title="definition">proph_id</span>) <a id="v:100" class="idref" href="#v:100"><span class="id" title="binder">v</span></a> (<a id="pvs:101" class="idref" href="#pvs:101"><span class="id" title="binder">pvs</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<span class="id" title="inductive">val</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <span class="id" title="inductive">val</span>)) :<br/>
&nbsp;&nbsp;<span class="id" title="class">Atomic</span> <span class="id" title="constructor">StronglyAtomic</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:97"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">to_val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:97"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">proph</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#p:99"><span class="id" title="variable">p</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#pvs:101"><span class="id" title="variable">pvs</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">WBWP</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:97"><span class="id" title="variable">e</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:96"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:95"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">{{</span></a> <a id="r:102" class="idref" href="#r:102"><span class="id" title="binder">r</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">,</span></a> <span class="id" title="notation">∀</span> <a id="pvs':103" class="idref" href="#pvs':103"><span class="id" title="binder">pvs'</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#pvs:101"><span class="id" title="variable">pvs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#r:102"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:100"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="WBLogic.heap_lang.primitive_laws.html#pvs':103"><span class="id" title="variable">pvs'</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="definition">proph</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#p:99"><span class="id" title="variable">p</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#pvs':103"><span class="id" title="variable">pvs'</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#848afab06bf12743b7d5ad588f763841"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#r:102"><span class="id" title="variable">r</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#0e94461d641dcf3403e79b3abed679d5"><span class="id" title="notation">}}</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">WBWP</span></a> <span class="id" title="constructor">Resolve</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#e:97"><span class="id" title="variable">e</span></a> (<span class="id" title="constructor">Val</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitV</span> <span class="id" title="notation">$</span> <span class="id" title="constructor">LitProphecy</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#p:99"><span class="id" title="variable">p</span></a>) (<span class="id" title="constructor">Val</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#v:100"><span class="id" title="variable">v</span></a>) <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">@</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#out:96"><span class="id" title="variable">out</span></a><a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">;</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#E:95"><span class="id" title="variable">E</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">{{</span></a> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#848afab06bf12743b7d5ad588f763841"><span class="id" title="variable">Φ</span></a> <a class="idref" href="WBLogic.program_logic.weakestpre.html#c4a2c4d7e3cc404db366e8ac4317091d"><span class="id" title="notation">}}</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (??) "Hpr HWBWP".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.program_logic.weakestpre.html#wbwp"><span class="id" title="definition">wbwp</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "HM". <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_resolve</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">wp_wand</span> <span class="id" title="notation">with</span> "[HWBWP HM]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "HWBWP".<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?); <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (?) "(?&amp;?&amp;H)".<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ?) "?".<br/>
&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iApply</span> "H"; <span class="id" title="var">done</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="WBLogic.heap_lang.primitive_laws.html#lifting"><span class="id" title="section">lifting</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
