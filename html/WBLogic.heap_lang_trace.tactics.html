<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../index.html">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">WBLogic.heap_lang_trace.tactics</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">fin_maps</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">WBLogic.heap_lang_trace</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#"><span class="id" title="library">lang</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">options</span>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang"><span class="id" title="module">heap_lang</span></a>.<br/>

<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="var">reshape_expr</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">tac</span></span> decomposes the expression <span class="inlinecode"><span class="id" title="var">e</span></span> into an
evaluation context <span class="inlinecode"><span class="id" title="var">K</span></span> and a subexpression <span class="inlinecode"><span class="id" title="var">e'</span></span>. It calls the tactic <span class="inlinecode"><span class="id" title="var">tac</span></span> <span class="inlinecode"><span class="id" title="var">K</span></span> <span class="inlinecode"><span class="id" title="var">e'</span></span>
for each possible decomposition until <span class="inlinecode"><span class="id" title="var">tac</span></span> succeeds. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note&nbsp;that&nbsp;the&nbsp;current&nbsp;context&nbsp;is&nbsp;spread&nbsp;into&nbsp;a&nbsp;list&nbsp;of&nbsp;fully-constructed<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;items&nbsp;<span class="inlinecode"><span class="id" title="var">K</span></span>,&nbsp;and&nbsp;a&nbsp;list&nbsp;of&nbsp;pairs&nbsp;of&nbsp;values&nbsp;<span class="inlinecode"><span class="id" title="var">vs</span></span>&nbsp;(prophecy&nbsp;identifier&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resolution&nbsp;value)&nbsp;that&nbsp;is&nbsp;only&nbsp;non-empty&nbsp;if&nbsp;a&nbsp;<span class="inlinecode"><span class="id" title="var">ResolveLCtx</span></span>&nbsp;item&nbsp;(maybe<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;having&nbsp;several&nbsp;levels)&nbsp;is&nbsp;in&nbsp;the&nbsp;process&nbsp;of&nbsp;being&nbsp;constructed.&nbsp;Note&nbsp;that<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;fully-constructed&nbsp;item&nbsp;is&nbsp;inserted&nbsp;into&nbsp;<span class="inlinecode"><span class="id" title="var">K</span></span>&nbsp;by&nbsp;calling&nbsp;<span class="inlinecode"><span class="id" title="var">add_item</span></span>,&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;is&nbsp;only&nbsp;the&nbsp;case&nbsp;when&nbsp;a&nbsp;non-<span class="inlinecode"><span class="id" title="var">ResolveLCtx</span></span>&nbsp;item&nbsp;is&nbsp;built.&nbsp;When&nbsp;<span class="inlinecode"><span class="id" title="var">vs</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;non-empty,&nbsp;<span class="inlinecode"><span class="id" title="var">add_item</span></span>&nbsp;also&nbsp;wraps&nbsp;the&nbsp;item&nbsp;under&nbsp;several&nbsp;<span class="inlinecode"><span class="id" title="var">ResolveLCtx</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constructors:&nbsp;one&nbsp;for&nbsp;each&nbsp;pair&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="var">vs</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">K</span> <span class="id" title="var">vs</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>                               =&gt; <span class="id" title="keyword">lazymatch</span> <span class="id" title="var">vs</span> <span class="id" title="keyword">with</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.App"><span class="id" title="constructor">App</span></a> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)                 =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AppLCtx"><span class="id" title="constructor">AppLCtx</span></a> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.App"><span class="id" title="constructor">App</span></a> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                     =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AppRCtx"><span class="id" title="constructor">AppRCtx</span></a> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.UnOp"><span class="id" title="constructor">UnOp</span></a> ?<span class="id" title="var">op</span> ?<span class="id" title="var">e</span>                     =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.UnOpCtx"><span class="id" title="constructor">UnOpCtx</span></a> <span class="id" title="var">op</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> ?<span class="id" title="var">op</span> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)           =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.BinOpLCtx"><span class="id" title="constructor">BinOpLCtx</span></a> <span class="id" title="var">op</span> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> ?<span class="id" title="var">op</span> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>               =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.BinOpRCtx"><span class="id" title="constructor">BinOpRCtx</span></a> <span class="id" title="var">op</span> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> ?<span class="id" title="var">e0</span> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                  =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.IfCtx"><span class="id" title="constructor">IfCtx</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Pair"><span class="id" title="constructor">Pair</span></a> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)                =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.PairLCtx"><span class="id" title="constructor">PairLCtx</span></a> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Pair"><span class="id" title="constructor">Pair</span></a> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                    =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.PairRCtx"><span class="id" title="constructor">PairRCtx</span></a> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> ?<span class="id" title="var">e</span>                          =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">FstCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Snd"><span class="id" title="constructor">Snd</span></a> ?<span class="id" title="var">e</span>                          =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">SndCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.InjL"><span class="id" title="constructor">InjL</span></a> ?<span class="id" title="var">e</span>                         =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">InjLCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.InjR"><span class="id" title="constructor">InjR</span></a> ?<span class="id" title="var">e</span>                         =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">InjRCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Case"><span class="id" title="constructor">Case</span></a> ?<span class="id" title="var">e0</span> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CaseCtx"><span class="id" title="constructor">CaseCtx</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)              =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AllocNLCtx"><span class="id" title="constructor">AllocNLCtx</span></a> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                  =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AllocNRCtx"><span class="id" title="constructor">AllocNRCtx</span></a> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Free"><span class="id" title="constructor">Free</span></a> ?<span class="id" title="var">e</span>                         =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">FreeCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> ?<span class="id" title="var">e</span>                         =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">LoadCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)               =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.StoreLCtx"><span class="id" title="constructor">StoreLCtx</span></a> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                   =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.StoreRCtx"><span class="id" title="constructor">StoreRCtx</span></a> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Xchg"><span class="id" title="constructor">Xchg</span></a> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)                =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.XchgLCtx"><span class="id" title="constructor">XchgLCtx</span></a> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Xchg"><span class="id" title="constructor">Xchg</span></a> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                    =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.XchgRCtx"><span class="id" title="constructor">XchgRCtx</span></a> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> ?<span class="id" title="var">e0</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v1</span>) (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v2</span>) =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchgLCtx"><span class="id" title="constructor">CmpXchgLCtx</span></a> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> ?<span class="id" title="var">e0</span> ?<span class="id" title="var">e1</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v2</span>)       =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchgMCtx"><span class="id" title="constructor">CmpXchgMCtx</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">v2</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> ?<span class="id" title="var">e0</span> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>             =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchgRCtx"><span class="id" title="constructor">CmpXchgRCtx</span></a> <span class="id" title="var">e0</span> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> ?<span class="id" title="var">e</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v</span>)                 =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.FaaLCtx"><span class="id" title="constructor">FaaLCtx</span></a> <span class="id" title="var">v</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>                     =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.FaaRCtx"><span class="id" title="constructor">FaaRCtx</span></a> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> ?<span class="id" title="var">ex</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v1</span>) (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v2</span>) =&gt; <span class="id" title="var">go</span> <span class="id" title="var">K</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">v1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">v2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">vs</span>) <span class="id" title="var">ex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> ?<span class="id" title="var">ex</span> ?<span class="id" title="var">e1</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> ?<span class="id" title="var">v2</span>)       =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.ResolveMCtx"><span class="id" title="constructor">ResolveMCtx</span></a> <span class="id" title="var">ex</span> <span class="id" title="var">v2</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Resolve"><span class="id" title="constructor">Resolve</span></a> ?<span class="id" title="var">ex</span> ?<span class="id" title="var">e1</span> ?<span class="id" title="var">e2</span>             =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.ResolveRCtx"><span class="id" title="constructor">ResolveRCtx</span></a> <span class="id" title="var">ex</span> <span class="id" title="var">e1</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Emit"><span class="id" title="constructor">Emit</span></a> ?<span class="id" title="var">e</span>                         =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">EmitCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.Fresh"><span class="id" title="constructor">Fresh</span></a> ?<span class="id" title="var">e</span>                        =&gt; <span class="id" title="var">add_item</span> <span class="id" title="var">FreshCtx</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">add_item</span> <span class="id" title="var">Ki</span> <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">vs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>               =&gt; <span class="id" title="var">go</span> (<span class="id" title="var">Ki</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">K</span>) (@<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>)) <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">v1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>?<span class="id" title="var">v2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> ?<span class="id" title="var">vs</span> =&gt; <span class="id" title="var">add_item</span> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.ResolveLCtx"><span class="id" title="constructor">ResolveLCtx</span></a> <span class="id" title="var">Ki</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span>) <span class="id" title="var">vs</span> <span class="id" title="var">K</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">go</span> (@<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.ectx_item"><span class="id" title="inductive">ectx_item</span></a>) (@<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>)) <span class="id" title="var">e</span>.<br/>

<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="var">inv_head_step</span></span> performs inversion on hypotheses of the shape
<span class="inlinecode"><a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a></span>. The tactic will discharge head-reductions starting from values, and
simplifies hypothesis related to conversions from and to values, and finite map
operations. This tactic is slightly ad-hoc and tuned for proving our lifting
lemmas. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_head_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">progress</span> <span class="id" title="var">simplify_map_eq</span>/= <span class="comment">(*&nbsp;simplify&nbsp;memory&nbsp;stuff&nbsp;*)</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.to_val"><span class="id" title="definition">to_val</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.of_to_val"><span class="id" title="lemma">of_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">is_var</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">fail</span> 1); <span class="comment">(*&nbsp;inversion&nbsp;yields&nbsp;many&nbsp;goals&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;is&nbsp;a&nbsp;variable<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;should&nbsp;thus&nbsp;better&nbsp;be&nbsp;avoided.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Create HintDb</span> <span class="id" title="var">head_step</span>.<br/>
<span class="id" title="keyword">Global Hint Extern</span> 0 (<span class="id" title="definition">head_reducible</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span> : <span class="id" title="var">head_step</span>.<br/>
<span class="id" title="keyword">Global Hint Extern</span> 0 (<span class="id" title="definition">head_reducible_no_obs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">eexists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>; <span class="id" title="tactic">simpl</span> : <span class="id" title="var">head_step</span>.<br/>

<br/>
<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="tactic">simpl</span></span> <span class="inlinecode"><span class="id" title="tactic">apply</span></span>&nbsp;is&nbsp;too&nbsp;stupid,&nbsp;so&nbsp;we&nbsp;need&nbsp;extern&nbsp;hints&nbsp;here.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Hint Extern</span> 1 (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">econstructor</span> : <span class="id" title="var">head_step</span>.<br/>
<span class="id" title="keyword">Global Hint Extern</span> 0 (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">eapply</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.CmpXchgS"><span class="id" title="constructor">CmpXchgS</span></a> : <span class="id" title="var">head_step</span>.<br/>
<span class="id" title="keyword">Global Hint Extern</span> 0 (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.AllocN"><span class="id" title="constructor">AllocN</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.alloc_fresh"><span class="id" title="lemma">alloc_fresh</span></a> : <span class="id" title="var">head_step</span>.<br/>
<span class="id" title="keyword">Global Hint Extern</span> 0 (<a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.head_step"><span class="id" title="inductive">head_step</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.NewProph"><span class="id" title="constructor">NewProph</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.new_proph_id_fresh"><span class="id" title="lemma">new_proph_id_fresh</span></a> : <span class="id" title="var">head_step</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
