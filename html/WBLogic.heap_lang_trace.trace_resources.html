<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../index.html">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">WBLogic.heap_lang_trace.trace_resources</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">stdpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">fin_maps</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">tactics</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">auth</span> <span class="id" title="library">excl</span> <span class="id" title="library">agree</span> <span class="id" title="library">gmap</span> <span class="id" title="library">list</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac_auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">proph_map</span> <span class="id" title="library">invariants</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">WBLogic.heap_lang_trace</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#"><span class="id" title="library">lang</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Proof</span> <span class="id" title="var">Using</span> "Type".<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="gmap_of_trace" class="idref" href="#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> {<a id="A:1" class="idref" href="#A:1"><span class="id" title="binder">A</span></a>} (<a id="n:2" class="idref" href="#n:2"><span class="id" title="binder">n</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:3" class="idref" href="#l:3"><span class="id" title="binder">l</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:1"><span class="id" title="variable">A</span></a>): <span class="id" title="record">gmap</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> (<span class="id" title="record">agree</span> (<span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:1"><span class="id" title="variable">A</span></a>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#l:3"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> =&gt; <span class="id" title="notation">&lt;[</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:2"><span class="id" title="variable">n</span></a> <span class="id" title="notation">:=</span> <span class="id" title="definition">to_agree</span> <span class="id" title="var">x</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">gmap_of_trace</span> <span class="id" title="notation">(</span><span class="id" title="notation">S</span> <span class="id" title="notation">n</span><span class="id" title="notation">)</span> <span class="id" title="notation">l'</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="gmap_of_trace_snoc" class="idref" href="#gmap_of_trace_snoc"><span class="id" title="lemma">gmap_of_trace_snoc</span></a> {<a id="A:6" class="idref" href="#A:6"><span class="id" title="binder">A</span></a>} <a id="n:7" class="idref" href="#n:7"><span class="id" title="binder">n</span></a> (<a id="l:8" class="idref" href="#l:8"><span class="id" title="binder">l</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:6"><span class="id" title="variable">A</span></a>) (<a id="a:9" class="idref" href="#a:9"><span class="id" title="binder">a</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:6"><span class="id" title="variable">A</span></a>):<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:7"><span class="id" title="variable">n</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#l:8"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#a:9"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;<span class="id" title="notation">&lt;[</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:7"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="abbreviation">length</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#l:8"><span class="id" title="variable">l</span></a>)%<span class="id" title="var">nat</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">to_agree</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#a:9"><span class="id" title="variable">a</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">gmap_of_trace</span> <span class="id" title="notation">n</span> <span class="id" title="notation">l</span><span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">x</span> <span class="id" title="var">l</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_0_r"><span class="id" title="lemma">Nat.add_0_r</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHl</span> /= -<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_succ_r"><span class="id" title="lemma">Nat.add_succ_r</span></a> <span class="id" title="lemma">insert_commute</span> //. <span class="id" title="var">lia</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="gmap_of_trace_dom" class="idref" href="#gmap_of_trace_dom"><span class="id" title="lemma">gmap_of_trace_dom</span></a> {<a id="A:10" class="idref" href="#A:10"><span class="id" title="binder">A</span></a>} (<a id="n:11" class="idref" href="#n:11"><span class="id" title="binder">n</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:12" class="idref" href="#l:12"><span class="id" title="binder">l</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:10"><span class="id" title="variable">A</span></a>) <a id="k:13" class="idref" href="#k:13"><span class="id" title="binder">k</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#k:13"><span class="id" title="variable">k</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:11"><span class="id" title="variable">n</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#l:12"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#d9d5c539a07c7350478e89358d1fe520"><span class="id" title="notation">↔</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:11"><span class="id" title="variable">n</span></a> <span class="id" title="notation">≤</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#k:13"><span class="id" title="variable">k</span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:11"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <span class="id" title="abbreviation">length</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#l:12"><span class="id" title="variable">l</span></a>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_empty_L</span> <span class="id" title="lemma">elem_of_empty</span>. <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span> <span class="id" title="method">elem_of_union</span> <span class="id" title="method">elem_of_singleton</span> <span class="id" title="var">IHl</span>. <span class="id" title="var">lia</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="eventO" class="idref" href="#eventO"><span class="id" title="definition">eventO</span></a> := <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="traceO" class="idref" href="#traceO"><span class="id" title="definition">traceO</span></a> := <span class="id" title="abbreviation">leibnizO</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>).<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="traceGS" class="idref" href="#traceGS"><span class="id" title="record">traceGS</span></a> <a id="08441172cd4c14450ee9e66c55932a87" class="idref" href="#08441172cd4c14450ee9e66c55932a87"><span class="id" title="binder">Σ</span></a> := <span class="id" title="var">TraceGS</span> {<br/>
&nbsp;&nbsp;<a id="trace_hist_inG" class="idref" href="#trace_hist_inG"><span class="id" title="projection">trace_hist_inG</span></a> :: <span class="id" title="class">inG</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">authR</span> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> (<span class="id" title="definition">agreeR</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#eventO"><span class="id" title="definition">eventO</span></a>)));<br/>
&nbsp;&nbsp;<a id="trace_hist_name" class="idref" href="#trace_hist_name"><span class="id" title="projection">trace_hist_name</span></a> : <span class="id" title="definition">gname</span>;<br/>
&nbsp;&nbsp;<a id="trace_inG" class="idref" href="#trace_inG"><span class="id" title="projection">trace_inG</span></a> :: <span class="id" title="class">inG</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">frac_authR</span> (<span class="id" title="definition">agreeR</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>));<br/>
&nbsp;&nbsp;<a id="trace_name" class="idref" href="#trace_name"><span class="id" title="projection">trace_name</span></a> : <span class="id" title="definition">gname</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="b181a4fc8c4bbb0b4a63cbb7e54f9b33" class="idref" href="#b181a4fc8c4bbb0b4a63cbb7e54f9b33"><span class="id" title="definition">traceΣ</span></a> : <span class="id" title="record">gFunctors</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">#[</span><span class="id" title="constructor">GFunctor</span> (<span class="id" title="definition">authR</span> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> (<span class="id" title="definition">agreeR</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#eventO"><span class="id" title="definition">eventO</span></a>)))<span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="constructor">GFunctor</span> (<span class="id" title="definition">frac_authR</span> (<span class="id" title="definition">agreeR</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>))<span class="id" title="notation">]</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="trace_preG" class="idref" href="#trace_preG"><span class="id" title="record">trace_preG</span></a> <a id="f8cd4500ff4fee5cd966dfeb97ee3847" class="idref" href="#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="binder">Σ</span></a> := <span class="id" title="var">TracePreG</span> {<br/>
&nbsp;&nbsp;<a id="trace_hist_preG_inG" class="idref" href="#trace_hist_preG_inG"><span class="id" title="projection">trace_hist_preG_inG</span></a> :: <span class="id" title="class">inG</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">authR</span> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> (<span class="id" title="definition">agreeR</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#eventO"><span class="id" title="definition">eventO</span></a>)));<br/>
&nbsp;&nbsp;<a id="trace_preG_inG" class="idref" href="#trace_preG_inG"><span class="id" title="projection">trace_preG_inG</span></a> :: <span class="id" title="class">inG</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#f8cd4500ff4fee5cd966dfeb97ee3847"><span class="id" title="variable">Σ</span></a> (<span class="id" title="definition">frac_authR</span> (<span class="id" title="definition">agreeR</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>));<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="subG_tracePreG" class="idref" href="#subG_tracePreG"><span class="id" title="instance">subG_tracePreG</span></a> {<a id="0ff5eed445d72e1c5ccedcdae1755936" class="idref" href="#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="binder">Σ</span></a>} : <span class="id" title="class">subG</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#b181a4fc8c4bbb0b4a63cbb7e54f9b33"><span class="id" title="definition">traceΣ</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_preG"><span class="id" title="class">trace_preG</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#0ff5eed445d72e1c5ccedcdae1755936"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">solve_inG</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Trace-related resources.

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a></span> asserts the ownership over the trace (it corresponds to <span class="inlinecode"><a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.trace"><span class="id" title="projection">trace</span></a></span>
     in the paper);

</li>
<li> <span class="inlinecode"><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_inv"><span class="id" title="definition">trace_inv</span></a></span> asserts that the trace preserves a given invariant (it is named
     <span class="inlinecode"><span class="id" title="var">traceInv</span></span> in the paper);

</li>
<li> <span class="inlinecode"><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a></span> describes a snapshot of the trace, as it was sometime in the past

</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="trace_auth" class="idref" href="#trace_auth"><span class="id" title="definition">trace_auth</span></a> `{<a id="hT:26" class="idref" href="#hT:26"><span class="id" title="binder">hT</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceGS"><span class="id" title="class">traceGS</span></a> <a id="7fd4a516bfc23c1706437f236b640793" class="idref" href="#7fd4a516bfc23c1706437f236b640793"><span class="id" title="binder">Σ</span></a>} (<a id="t:27" class="idref" href="#t:27"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="definition">own</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_name"><span class="id" title="method">trace_name</span></a> (<span class="id" title="notation">●</span><span class="id" title="notation">F</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:27"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>)<span class="id" title="notation">)</span>))%<span class="id" title="var">I</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="hist" class="idref" href="#hist"><span class="id" title="definition">hist</span></a> `{<a id="hT:29" class="idref" href="#hT:29"><span class="id" title="binder">hT</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceGS"><span class="id" title="class">traceGS</span></a> <a id="eb789037a8f6adae4a3a57f4d9f80b3c" class="idref" href="#eb789037a8f6adae4a3a57f4d9f80b3c"><span class="id" title="binder">Σ</span></a>} (<a id="t:30" class="idref" href="#t:30"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_hist_name"><span class="id" title="method">trace_hist_name</span></a> (<span class="id" title="notation">◯</span> <span class="id" title="notation">(</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> 0 <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:30"><span class="id" title="variable">t</span></a><span class="id" title="notation">)</span>).<br/>
<span class="id" title="keyword">Definition</span> <a id="trace_half_frag" class="idref" href="#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> `{<a id="hT:32" class="idref" href="#hT:32"><span class="id" title="binder">hT</span></a>:<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceGS"><span class="id" title="class">traceGS</span></a>} (<a id="t:33" class="idref" href="#t:33"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_name"><span class="id" title="method">trace_name</span></a> (<span class="id" title="notation">◯</span><span class="id" title="notation">F</span><span class="id" title="notation">{</span>1<span class="id" title="notation">/</span>2<span class="id" title="notation">}</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:33"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>)<span class="id" title="notation">)</span>).<br/>
<span class="id" title="keyword">Definition</span> <a id="trace_is" class="idref" href="#trace_is"><span class="id" title="definition">trace_is</span></a> `{<a id="hT:35" class="idref" href="#hT:35"><span class="id" title="binder">hT</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceGS"><span class="id" title="class">traceGS</span></a> <a id="c9c14b58eeeaee559bef0d4f884fa28f" class="idref" href="#c9c14b58eeeaee559bef0d4f884fa28f"><span class="id" title="binder">Σ</span></a>} (<a id="t:36" class="idref" href="#t:36"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :=<br/>
&nbsp;&nbsp;(<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:36"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">own</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_hist_name"><span class="id" title="method">trace_hist_name</span></a> (<span class="id" title="notation">●</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> 0 <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:36"><span class="id" title="variable">t</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:36"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">I</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="trace_inv" class="idref" href="#trace_inv"><span class="id" title="definition">trace_inv</span></a> `{<a id="hT:38" class="idref" href="#hT:38"><span class="id" title="binder">hT</span></a>:<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceGS"><span class="id" title="class">traceGS</span></a> <a id="01696af10e39986da2e9d1f22eb04999" class="idref" href="#01696af10e39986da2e9d1f22eb04999"><span class="id" title="binder">Σ</span></a>, <a id="hI:39" class="idref" href="#hI:39"><span class="id" title="binder">hI</span></a>:<span class="id" title="abbreviation">invGS</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#01696af10e39986da2e9d1f22eb04999"><span class="id" title="variable">Σ</span></a>} (<a id="N:40" class="idref" href="#N:40"><span class="id" title="binder">N</span></a>: <span class="id" title="definition">namespace</span>) (<a id="I:41" class="idref" href="#I:41"><span class="id" title="binder">I</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">inv</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#N:40"><span class="id" title="variable">N</span></a> (<span class="id" title="notation">∃</span> <a id="t:42" class="idref" href="#t:42"><span class="id" title="binder">t</span></a><span class="id" title="notation">,</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:42"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#I:41"><span class="id" title="variable">I</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:42"><span class="id" title="variable">t</span></a><span class="id" title="notation">⌝</span>).<br/>

<br/>
</div>

<div class="doc">
Reasoning rules for the trace predicates 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Global Instance</span> <a id="hist_persistent" class="idref" href="#hist_persistent"><span class="id" title="instance">hist_persistent</span></a> `{<a id="H:44" class="idref" href="#H:44"><span class="id" title="binder">traceGS</span></a> <a id="ea478fd00cb4a06cc640b1b27bf65159" class="idref" href="#ea478fd00cb4a06cc640b1b27bf65159"><span class="id" title="binder"><span id="H:44" class="id">Σ</span></span></a>} (<a id="t:45" class="idref" href="#t:45"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>): <span class="id" title="class">Persistent</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:45"><span class="id" title="variable">t</span></a>) := <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="alloc_hist" class="idref" href="#alloc_hist"><span class="id" title="lemma">alloc_hist</span></a> `{<a id="H:47" class="idref" href="#H:47"><span class="id" title="binder">traceGS</span></a> <a id="f850f5b668e843742fbd7a0a15104996" class="idref" href="#f850f5b668e843742fbd7a0a15104996"><span class="id" title="binder"><span id="H:47" class="id">Σ</span></span></a>} <a id="t:48" class="idref" href="#t:48"><span class="id" title="binder">t</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:48"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:48"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:48"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a>. <span class="id" title="var">iIntros</span> "(? &amp; ? &amp; #H)". <span class="id" title="var">iFrame</span> "H ∗".<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_auth_half_frag_agree" class="idref" href="#trace_auth_half_frag_agree"><span class="id" title="lemma">trace_auth_half_frag_agree</span></a> `{<a id="H:50" class="idref" href="#H:50"><span class="id" title="binder">traceGS</span></a> <a id="bee78f44e79dd1f39e7aa3afe03ef2db" class="idref" href="#bee78f44e79dd1f39e7aa3afe03ef2db"><span class="id" title="binder"><span id="H:50" class="id">Σ</span></span></a>} <a id="t:51" class="idref" href="#t:51"><span class="id" title="binder">t</span></a> <a id="t':52" class="idref" href="#t':52"><span class="id" title="binder">t'</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:51"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t':52"><span class="id" title="variable">t'</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:51"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t':52"><span class="id" title="variable">t'</span></a><span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hi</span>%<span class="id" title="lemma">frac_auth_included</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="lemma">Some_included_total</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">to_agree_included</span>, <span class="id" title="definition">leibniz_equiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_agree" class="idref" href="#trace_agree"><span class="id" title="lemma">trace_agree</span></a> `{<a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">traceGS</span></a> <a id="20d7c0ecc86fe88fa924e57d0c585b54" class="idref" href="#20d7c0ecc86fe88fa924e57d0c585b54"><span class="id" title="binder"><span id="H:54" class="id">Σ</span></span></a>} <a id="t:55" class="idref" href="#t:55"><span class="id" title="binder">t</span></a> <a id="t':56" class="idref" href="#t':56"><span class="id" title="binder">t'</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:55"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t':56"><span class="id" title="variable">t'</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:55"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t':56"><span class="id" title="variable">t'</span></a><span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 (H2 &amp; _ &amp; _)". <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth_half_frag_agree"><span class="id" title="lemma">trace_auth_half_frag_agree</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_half_frag_agree" class="idref" href="#trace_half_frag_agree"><span class="id" title="lemma">trace_half_frag_agree</span></a> `{<a id="H:58" class="idref" href="#H:58"><span class="id" title="binder">traceGS</span></a> <a id="cb0630687a5a3dec7d46ec6926ccb84b" class="idref" href="#cb0630687a5a3dec7d46ec6926ccb84b"><span class="id" title="binder"><span id="H:58" class="id">Σ</span></span></a>} <a id="t:59" class="idref" href="#t:59"><span class="id" title="binder">t</span></a> <a id="t':60" class="idref" href="#t':60"><span class="id" title="binder">t'</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:59"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t':60"><span class="id" title="variable">t'</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:59"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t':60"><span class="id" title="variable">t'</span></a><span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 (H2 &amp; _ &amp; _)".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">frac_auth_frag_op</span> <span class="id" title="lemma">Qp.half_half</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hv</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">frac_auth_frag_valid</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Hv</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">to_agree_op_inv</span>, <span class="id" title="definition">leibniz_equiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_add_event" class="idref" href="#trace_add_event"><span class="id" title="lemma">trace_add_event</span></a> `{<a id="H:62" class="idref" href="#H:62"><span class="id" title="binder">traceGS</span></a> <a id="77616297ab8389c2db18b8aa996822b8" class="idref" href="#77616297ab8389c2db18b8aa996822b8"><span class="id" title="binder"><span id="H:62" class="id">Σ</span></span></a>} <a id="t:63" class="idref" href="#t:63"><span class="id" title="binder">t</span></a> (<a id="e:64" class="idref" href="#e:64"><span class="id" title="binder">e</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:63"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:63"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:63"><span class="id" title="variable">t</span></a> <span class="id" title="notation">==∗</span><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:63"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#e:64"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:63"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#e:64"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:63"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#e:64"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 (H2 &amp; H2ha &amp; H2h) H3".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_op</span> <span class="id" title="notation">with</span> "[$H2 $H3]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H2".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">frac_auth_frag_op</span> <span class="id" title="lemma">Qp.half_half</span> <span class="id" title="lemma">agree_idemp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update_2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="notation">●</span><span class="id" title="notation">F</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> (<span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⋅</span> <span class="id" title="notation">◯</span><span class="id" title="notation">F</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> (<span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>)<span class="id" title="notation">)</span>) <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">frac_auth_update_1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace_snoc"><span class="id" title="lemma">gmap_of_trace_snoc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.add_0_l"><span class="id" title="lemma">Nat.add_0_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update_2</span> <span class="id" title="notation">with</span> "H2ha H2h"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">auth_update</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">alloc_local_update</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="abbreviation">length</span> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="definition">to_agree</span> (<span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#eventO"><span class="id" title="definition">eventO</span></a>))); [|<span class="id" title="var">done</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">intros</span> ?%<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace_dom"><span class="id" title="lemma">gmap_of_trace_dom</span></a>. <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> -<span class="id" title="lemma">own_op</span> -<span class="id" title="lemma">frac_auth_frag_op</span> <span class="id" title="lemma">Qp.half_half</span> <span class="id" title="lemma">agree_idemp</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">all</span>: <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="gmap_of_trace_hist_valid_prefix" class="idref" href="#gmap_of_trace_hist_valid_prefix"><span class="id" title="lemma">gmap_of_trace_hist_valid_prefix</span></a> `{<a id="H:66" class="idref" href="#H:66"><span class="id" title="binder">traceGS</span></a> <a id="b7d14475a959a414c26c016f9aef0e47" class="idref" href="#b7d14475a959a414c26c016f9aef0e47"><span class="id" title="binder"><span id="H:66" class="id">Σ</span></span></a>} {<a id="A:67" class="idref" href="#A:67"><span class="id" title="binder">A</span></a>} <a id="n:68" class="idref" href="#n:68"><span class="id" title="binder">n</span></a> (<a id="t:69" class="idref" href="#t:69"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:67"><span class="id" title="variable">A</span></a>) <a id="h:70" class="idref" href="#h:70"><span class="id" title="binder">h</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="notation">✓</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:68"><span class="id" title="variable">n</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:69"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:68"><span class="id" title="variable">n</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#h:70"><span class="id" title="variable">h</span></a> <span class="id" title="notation">≼</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:68"><span class="id" title="variable">n</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:69"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#h:70"><span class="id" title="variable">h</span></a> <span class="id" title="notation">`</span><span class="id" title="notation">prefix_of</span><span class="id" title="notation">`</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:69"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">h</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">h</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">prefix_nil</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">t</span> <span class="id" title="var">Hv</span> <span class="id" title="var">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="lemma">lookup_included</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">Hsub</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsub'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">e</span> <span class="id" title="var">t</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">exfalso</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hsub'</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= <span class="id" title="lemma">lookup_insert</span> <span class="id" title="method">lookup_empty</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">option_included</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HH</span>|(? &amp; ? &amp; ? &amp; <span class="id" title="var">HH</span> &amp; ?)]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">HH</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hsub'</span> <span class="id" title="var">n</span>). <span class="id" title="tactic">rewrite</span> /= !<span class="id" title="lemma">lookup_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="lemma">Some_included_total</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="lemma">to_agree_included</span> (<span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a><span class="id" title="abbreviation">leibnizO</span> <span class="id" title="var">A</span>) <span class="id" title="var">e</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="definition">leibniz_equiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub'</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="lemma">delete_valid</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">rewrite</span> /= <span class="id" title="lemma">delete_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">intros</span> ?%<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace_dom"><span class="id" title="lemma">gmap_of_trace_dom</span></a>. <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>) <span class="id" title="var">h</span> <span class="id" title="notation">≼</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>) <span class="id" title="var">t</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_included</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="lemma">lookup_included</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="keyword">with</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">n</span>)); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>) <span class="id" title="var">h</span> <span class="id" title="notation">!!</span> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span>) <span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">not_elem_of_dom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">intros</span> ?%<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace_dom"><span class="id" title="lemma">gmap_of_trace_dom</span></a>; <span class="id" title="var">lia</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">lookup_insert_ne</span> // <span class="id" title="tactic">in</span> <span class="id" title="var">Hsub</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">prefix_cons</span>, <span class="id" title="var">IHh</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">all</span>: <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="hist_trace_is_prefix" class="idref" href="#hist_trace_is_prefix"><span class="id" title="lemma">hist_trace_is_prefix</span></a> `{<a id="H:72" class="idref" href="#H:72"><span class="id" title="binder">traceGS</span></a> <a id="71207c1fa4df2a6ffd92a3b175d4607f" class="idref" href="#71207c1fa4df2a6ffd92a3b175d4607f"><span class="id" title="binder"><span id="H:72" class="id">Σ</span></span></a>} <a id="t:73" class="idref" href="#t:73"><span class="id" title="binder">t</span></a> <a id="h:74" class="idref" href="#h:74"><span class="id" title="binder">h</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:73"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#h:74"><span class="id" title="variable">h</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#h:74"><span class="id" title="variable">h</span></a> <span class="id" title="notation">`</span><span class="id" title="notation">prefix_of</span><span class="id" title="notation">`</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:73"><span class="id" title="variable">t</span></a> <span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a>. <span class="id" title="var">iIntros</span> "(H1 &amp; H2 &amp; H3) H4".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_op</span> <span class="id" title="notation">with</span> "[$H2 $H4]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid</span> <span class="id" title="notation">with</span> "H"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %[<span class="id" title="var">Hsub</span> <span class="id" title="var">Hv</span>]%<span class="id" title="lemma">auth_both_valid_discrete</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace_hist_valid_prefix"><span class="id" title="lemma">gmap_of_trace_hist_valid_prefix</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_is_inv" class="idref" href="#trace_is_inv"><span class="id" title="lemma">trace_is_inv</span></a> `{<a id="H:76" class="idref" href="#H:76"><span class="id" title="binder">traceGS</span></a> <a id="5e616d60b6019fd1fcdddd9ee38e237a" class="idref" href="#5e616d60b6019fd1fcdddd9ee38e237a"><span class="id" title="binder"><span id="H:76" class="id">Σ</span></span></a>, <a id="invGS0:77" class="idref" href="#invGS0:77"><span class="id" title="binder">invGS</span></a> <a id="invGS0:77" class="idref" href="#invGS0:77"><span class="id" title="binder">Σ</span></a>} <a id="t:78" class="idref" href="#t:78"><span class="id" title="binder">t</span></a> <a id="N:79" class="idref" href="#N:79"><span class="id" title="binder">N</span></a> <a id="I:80" class="idref" href="#I:80"><span class="id" title="binder">I</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:78"><span class="id" title="variable">t</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_inv"><span class="id" title="definition">trace_inv</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#N:79"><span class="id" title="variable">N</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#I:80"><span class="id" title="variable">I</span></a> <span class="id" title="notation">={</span><span class="id" title="notation">⊤</span><span class="id" title="notation">}=∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:78"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#I:80"><span class="id" title="variable">I</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:78"><span class="id" title="variable">t</span></a> <span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ht Hi". <span class="id" title="tactic">unfold</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_inv"><span class="id" title="definition">trace_inv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iInv</span> <span class="id" title="var">N</span> <span class="id" title="keyword">as</span> "&gt;H" "Hclose". <span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">t'</span>) "(Ht' &amp; %)".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag_agree"><span class="id" title="lemma">trace_half_frag_agree</span></a> <span class="id" title="notation">with</span> "[$] [$]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"Hclose" <span class="id" title="notation">with</span> "[Ht']"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="var">iIntros</span> "!&gt;". <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="gmap_of_trace_valid" class="idref" href="#gmap_of_trace_valid"><span class="id" title="lemma">gmap_of_trace_valid</span></a> {<a id="A:81" class="idref" href="#A:81"><span class="id" title="binder">A</span></a>} (<a id="l:82" class="idref" href="#l:82"><span class="id" title="binder">l</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#A:81"><span class="id" title="variable">A</span></a>) (<a id="n:83" class="idref" href="#n:83"><span class="id" title="binder">n</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>):<br/>
&nbsp;&nbsp;<span class="id" title="notation">✓</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#n:83"><span class="id" title="variable">n</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#l:82"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="var">done</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">eapply</span> (@<span class="id" title="lemma">insert_valid</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="definition">agreeR</span> (<span class="id" title="abbreviation">leibnizO</span> <span class="id" title="var">A</span>))); <span class="id" title="tactic">eauto</span>; <span class="id" title="var">done</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="trace_auth_init" class="idref" href="#trace_auth_init"><span class="id" title="lemma">trace_auth_init</span></a> `{<a id="hT:85" class="idref" href="#hT:85"><span class="id" title="binder">hT</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_preG"><span class="id" title="class">trace_preG</span></a> <a id="a5bae1297469f77e34a5c13ef06bb586" class="idref" href="#a5bae1297469f77e34a5c13ef06bb586"><span class="id" title="binder">Σ</span></a>} (<a id="t:86" class="idref" href="#t:86"><span class="id" title="binder">t</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="WBLogic.heap_lang_trace.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>) :<br/>
&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">∃</span> <a id="H:87" class="idref" href="#H:87"><span class="id" title="binder">H</span></a>: <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceGS"><span class="id" title="class">traceGS</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#a5bae1297469f77e34a5c13ef06bb586"><span class="id" title="variable">Σ</span></a><span class="id" title="notation">,</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:86"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:86"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#t:86"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="lemma">own_alloc</span> (<span class="id" title="notation">●</span><span class="id" title="notation">F</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> (<span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⋅</span> <span class="id" title="notation">◯</span><span class="id" title="notation">F</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> (<span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#traceO"><span class="id" title="definition">traceO</span></a>)<span class="id" title="notation">)</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">γ</span>) "Hγ".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">frac_auth_valid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">own_op</span>. <span class="id" title="var">iDestruct</span> "Hγ" <span class="id" title="keyword">as</span> "[? Hγf]".<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> (<span class="id" title="lemma">own_alloc</span> (<span class="id" title="notation">●</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> 0 <span class="id" title="var">t</span> <span class="id" title="notation">⋅</span> <span class="id" title="notation">◯</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace"><span class="id" title="definition">gmap_of_trace</span></a> 0 <span class="id" title="var">t</span>)) <span class="id" title="keyword">as</span> (<span class="id" title="var">γh</span>) "Hγh".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">auth_both_valid</span>. <span class="id" title="tactic">split</span>; [ <span class="id" title="var">done</span> | <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#gmap_of_trace_valid"><span class="id" title="lemma">gmap_of_trace_valid</span></a>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">own_op</span>. <span class="id" title="var">iDestruct</span> "Hγh" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iExists</span> (<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#TraceGS"><span class="id" title="constructor">TraceGS</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">γh</span> <span class="id" title="var">_</span> <span class="id" title="var">γ</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_auth"><span class="id" title="definition">trace_auth</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_is"><span class="id" title="definition">trace_is</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#trace_half_frag"><span class="id" title="definition">trace_half_frag</span></a> /<a class="idref" href="WBLogic.heap_lang_trace.trace_resources.html#hist"><span class="id" title="definition">hist</span></a>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<span class="id" title="lemma">own_op</span> -<span class="id" title="lemma">frac_auth_frag_op</span> <span class="id" title="lemma">Qp.half_half</span> <span class="id" title="lemma">agree_idemp</span> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
